<!DOCTYPE html>
<html lang="en">

  <head>
    <!--#include file="/.shared/head.html" -->
    <title>docker development container for node - ephjos</title>
  </head>

  <body>
    <!--#include file="/.shared/nav.html" -->
    <main>
      <span>2021/11/12</span>
      <h2>docker development container for node</h2>

      <section>
        <p>
        Using a docker container for node.js development is a good idea for
        a few reasons. It easily allows the development environment to be
        shared with others and provides <i>some</i> amount of separation
        from the host system. While far from being locked-down, running
        <code>npm install</code> inside of the container can help prevent
        install scripts from exploiting the host machine. Given how common
        <a href="https://github.com/advisories?query=severity%3Acritical">
          these types of vulnerabilities</a> have become, this is something
        that any npm user should be aware of.

        <p>
        The setup is simple, consisting of a <code>Dockerfile</code>,
        <code>docker-compose.yml</code>, and a single <code>package.json</code>
        script. This will let you spin up the container and get a shell inside
        of it to install packages and run commands. It can be further modified
        to automatically run a command and be used for deployment, but I'll
        leave that as an exercise for the reader.

        <h3>Dockerfile</h3>
        <pre><code>FROM node:latest
WORKDIR /app/
COPY package.json .
RUN npm install
COPY . .</pre></code>

        <h3>docker-compose.yml</h3>
        <pre><code>version: '3.8'
services:
  project:
    build:
      context: .
    command: bash
    volumes:
      - .:/app/
      - /app/node_modules</pre></code>

        <h3>package.json</h3>
        <p>
        You can use an existing package.json, or create one for yourself by
        running <code>npm init</code>.
        <pre><code>...
  "scripts": {
    ...
    "docker:shell": "docker-compose run project",
    ...
  },
...</pre></code>

        <p>
        Once that's setup, run <code>docker-compose up --build -d</code> to
        start the container and then <code>npm run docker:shell</code>
        to get a shell inside of it. From their <code>npm install</code>
        and everything is up and running! Get out of the container by running
        <code>exit</code> inside of it. Use
        <code>docker-compose down -v</code> outside of the container
        to completely tear it down if you want a clean start.

        <p>
        If you plan to run a server, you need to be sure to expose and use
        the proper ports. Thanks to the container being mounted in the project
        directory, you can use your favorite editor to create and modify files
        on your host system while running them on the container.

        <p>
        This is far from perfect, but is a step in the right direction
        and should provide some value to the developer and <i>maybe</i>
        some small amount of security.

      </section>
    </main>

    <!--#include file="/.shared/footer.html" -->
  </body>
</html>
