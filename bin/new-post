#!/bin/sh

create_file() {
  if [ -z "$1" ]; then
    echo "No filename provided"
    exit 1
  fi

  if [[ $1 =~ \.html$ ]]; then
    echo "File does has an .html extension"
    exit 2
  fi

  mkdir -pv "./public/$(dirname "$1")"
  cp -nv "./public/.shared/post-template.html" "./public/$1/index.html"
}

run_update() {
  sh ./bin/update
}

update_file() {
  eval "$EDITOR" "./public/$1"
}

edit_file() {
  eval "$EDITOR" "./public/$1"
}

finish() {
  read -p "Press enter to push changes"
  make push
}

create_file "$@"
update_file "$@"
run_update "$@"
edit_file "$@"
finish "$@"
